<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Search Functionality Test</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        .search-container {
            max-width: 48rem;
            margin: 2rem auto;
        }
        .suggestions-panel {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(8px);
            border: 1px solid #e5e7eb;
            border-radius: 0.75rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            margin-top: 0.25rem;
            max-height: 20rem;
            overflow-y: auto;
            /* Hide scrollbars */
            scrollbar-width: none;
            -ms-overflow-style: none;
        }

        .suggestions-panel::-webkit-scrollbar {
            display: none;
        }
        .suggestion-item {
            padding: 0.75rem 1rem;
            cursor: pointer;
            border-bottom: 1px solid #f3f4f6;
        }
        .suggestion-item:hover,
        .suggestion-item.highlighted {
            background: #f9fafb;
        }
        .suggestion-item:last-child {
            border-bottom: none;
        }
        .clear-button {
            opacity: 0;
            transition: opacity 0.2s;
        }
        .has-value .clear-button {
            opacity: 1;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <div class="search-container">
        <h1 class="text-2xl font-bold text-center mb-8">Search Functionality Test</h1>

        <!-- Search Bar -->
        <div class="relative">
            <div role="combobox" aria-expanded="false" aria-haspopup="listbox">
                <input
                    id="search-input"
                    type="text"
                    placeholder="Search videos, films, and series..."
                    class="w-full h-16 rounded-full border-2 border-gray-300 bg-white text-gray-900 pl-14 pr-32 py-5 text-lg placeholder:text-gray-500 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                    aria-label="Search videos, films, and series"
                />

                <!-- Search icon -->
                <div class="absolute left-5 top-1/2 -translate-y-1/2 text-gray-400">
                    <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                    </svg>
                </div>
            </div>

            <!-- Right side buttons -->
            <div class="absolute right-3 top-1/2 -translate-y-1/2 flex items-center gap-2">
                <!-- Clear button -->
                <button
                    id="clear-button"
                    class="clear-button h-10 w-10 rounded-full text-gray-400 hover:text-gray-600 hover:bg-gray-100 focus:ring-2 focus:ring-blue-500 focus:ring-offset-0 transition-colors"
                    aria-label="Clear search"
                >
                    <svg class="h-4 w-4 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>

                <!-- Submit button -->
                <button
                    id="submit-button"
                    class="h-10 px-6 rounded-full font-medium bg-blue-600 text-white hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-0 transition-colors"
                    aria-label="Submit search"
                >
                    Search
                </button>
            </div>
        </div>

        <!-- Suggestions Panel -->
        <div id="suggestions-panel" class="suggestions-panel hidden">
            <div class="flex items-center gap-2 px-4 py-2 text-sm text-gray-600 border-b border-gray-200">
                <svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path>
                </svg>
                <span>Popular searches</span>
            </div>
            <div id="suggestions-list">
                <!-- Suggestions will be populated here -->
            </div>
        </div>

        <!-- Results/Test Output -->
        <div class="mt-8">
            <h2 class="text-lg font-semibold mb-4">Test Results:</h2>
            <div id="test-output" class="bg-white p-4 rounded-lg border">
                <p class="text-gray-600">Interact with the search bar above to see test results...</p>
            </div>
        </div>
    </div>

    <script>
        // Sample trending searches data (more items to test scrolling)
        const trendingSearches = [
            "Jesus", "Bible Stories", "Gospel", "Christian", "Faith",
            "Prayer", "Hope", "Love", "Salvation", "Holy Spirit",
            "Disciples", "Miracles", "Parables", "Resurrection",
            "Kingdom of God", "Ten Commandments", "David and Goliath",
            "Noah's Ark", "Christmas Story", "Easter", "Forgiveness",
            "Grace", "Worship", "Testimonies", "Missionary"
        ];

        const searchInput = document.getElementById('search-input');
        const clearButton = document.getElementById('clear-button');
        const submitButton = document.getElementById('submit-button');
        const suggestionsPanel = document.getElementById('suggestions-panel');
        const suggestionsList = document.getElementById('suggestions-list');
        const testOutput = document.getElementById('test-output');
        const searchContainer = searchInput.closest('.relative');

        let highlightedIndex = -1;
        let suggestions = [];
        let isSuggestionsOpen = false;

        // Test logging function
        function logTest(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const colorClass = type === 'success' ? 'text-green-600' :
                              type === 'error' ? 'text-red-600' :
                              type === 'warning' ? 'text-yellow-600' : 'text-blue-600';

            testOutput.innerHTML += `<p class="${colorClass}">[${timestamp}] ${message}</p>`;
            testOutput.scrollTop = testOutput.scrollHeight;
        }

        // Update clear button visibility
        function updateClearButton() {
            const hasValue = searchInput.value.trim().length > 0;
            searchContainer.classList.toggle('has-value', hasValue);

            if (hasValue) {
                logTest('Clear button should be visible', 'success');
            }
        }

        // Show suggestions
        function showSuggestions(query = '') {
            suggestions = query.trim() === '' ? trendingSearches : trendingSearches.filter(item =>
                item.toLowerCase().includes(query.toLowerCase())
            );

            renderSuggestions();
            suggestionsPanel.classList.remove('hidden');
            isSuggestionsOpen = true;
            highlightedIndex = -1;

            logTest(`Suggestions shown: ${suggestions.length} items`, 'success');
        }

        // Hide suggestions
        function hideSuggestions() {
            suggestionsPanel.classList.add('hidden');
            isSuggestionsOpen = false;
            highlightedIndex = -1;

            logTest('Suggestions hidden', 'info');
        }

        // Render suggestions list
        function renderSuggestions() {
            suggestionsList.innerHTML = '';

            suggestions.forEach((suggestion, index) => {
                const item = document.createElement('div');
                item.className = `suggestion-item flex items-center gap-3 ${index === highlightedIndex ? 'highlighted' : ''}`;

                item.innerHTML = `
                    <svg class="h-4 w-4 text-gray-400 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                    </svg>
                    <span class="flex-1 truncate">${suggestion}</span>
                `;

                item.addEventListener('click', () => selectSuggestion(suggestion));
                item.addEventListener('mouseenter', () => highlightSuggestion(index));

                suggestionsList.appendChild(item);
            });
        }

        // Select suggestion
        function selectSuggestion(suggestion) {
            searchInput.value = suggestion;
            updateClearButton();
            hideSuggestions();
            logTest(`Suggestion selected: "${suggestion}"`, 'success');
        }

        // Highlight suggestion
        function highlightSuggestion(index) {
            highlightedIndex = index;
            renderSuggestions();
        }

        // Event listeners
        searchInput.addEventListener('input', (e) => {
            const value = e.target.value;
            updateClearButton();

            if (value.trim().length > 0) {
                showSuggestions(value);
            } else {
                showSuggestions();
            }

            logTest(`Input changed: "${value}"`, 'info');
        });

        searchInput.addEventListener('focus', () => {
            showSuggestions(searchInput.value);
            logTest('Input focused - suggestions should appear', 'info');
        });

        searchInput.addEventListener('blur', () => {
            // Delay to allow suggestion clicks
            setTimeout(() => {
                if (!isSuggestionsOpen) return;
                hideSuggestions();
            }, 150);
        });

        searchInput.addEventListener('keydown', (e) => {
            if (!isSuggestionsOpen || suggestions.length === 0) return;

            switch (e.key) {
                case 'ArrowDown':
                    e.preventDefault();
                    highlightedIndex = highlightedIndex < suggestions.length - 1 ? highlightedIndex + 1 : 0;
                    highlightSuggestion(highlightedIndex);
                    logTest(`Arrow down - highlighted index: ${highlightedIndex}`, 'info');
                    break;
                case 'ArrowUp':
                    e.preventDefault();
                    highlightedIndex = highlightedIndex > 0 ? highlightedIndex - 1 : suggestions.length - 1;
                    highlightSuggestion(highlightedIndex);
                    logTest(`Arrow up - highlighted index: ${highlightedIndex}`, 'info');
                    break;
                case 'Enter':
                    e.preventDefault();
                    if (highlightedIndex >= 0) {
                        selectSuggestion(suggestions[highlightedIndex]);
                    } else {
                        logTest('Enter pressed - should submit search', 'success');
                    }
                    break;
                case 'Escape':
                    e.preventDefault();
                    hideSuggestions();
                    logTest('Escape pressed - suggestions should close', 'info');
                    break;
            }
        });

        clearButton.addEventListener('click', () => {
            searchInput.value = '';
            updateClearButton();
            showSuggestions(); // Show popular suggestions
            searchInput.focus();
            logTest('Clear button clicked - input cleared and focused', 'success');
        });

        submitButton.addEventListener('click', () => {
            const value = searchInput.value;
            logTest(`Submit button clicked with value: "${value}"`, 'success');
        });

        // Initialize
        logTest('Search functionality test initialized', 'success');
        logTest('Try typing in the search box to test suggestions', 'info');
        logTest('Test keyboard navigation with arrow keys', 'info');
        logTest('Test clear button functionality', 'info');
    </script>
</body>
</html>
