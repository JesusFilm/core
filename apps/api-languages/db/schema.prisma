// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider      = "prisma-client-js"
  output        = env("PRISMA_LOCATION_LANGUAGES")
  binaryTargets = ["native", "linux-musl-openssl-3.0.x"]
}

generator erd {
  provider    = "prisma-erd-generator"
  ignoreEnums = true
  disabled    = true
}

datasource db {
  provider = "postgresql"
  url      = env("PG_DATABASE_URL_LANGUAGES")
}

generator pothos {
  provider     = "prisma-pothos-types"
  clientOutput = env("PRISMA_LOCATION_LANGUAGES")
  output       = "../src/__generated__/pothos-types.ts"
}

model Language {
  id           String         @id
  createdAt    DateTime       @default(now())
  updatedAt    DateTime       @updatedAt
  bcp47        String?
  iso3         String?
  name         LanguageName[] @relation(name: "name")
  nameLanguage LanguageName[] @relation(name: "nameLanguage")

  @@index(bcp47(type: Hash))
}

model LanguageName {
  id               String   @id @default(uuid())
  value            String
  languageId       String
  primary          Boolean
  parentLanguageId String
  language         Language @relation(name: "nameLanguage", fields: [languageId], references: [id])
  parent           Language @relation(name: "name", fields: [parentLanguageId], references: [id])

  @@unique([parentLanguageId, languageId])
  @@unique([parentLanguageId, primary])
  @@index(parentLanguageId(type: Hash))
  @@index(primary(type: Hash))
  @@index(languageId(type: Hash))
}
