import CrowdinTranslations from './crowdin-translations.png'
import LanguageTranslated from './language-translated.png'

# Translation Process

## Crowdin

After your files have been committed and your pull request (PR) has been merged into production, our [Crowdin GitHub integration](https://support.crowdin.com/github-integration/) will initiate. This process involves uploading any changes to the `locales/en` directory.

### DeepL

We have incorporated [DeepL](https://www.deepl.com/en/translator), an AI-powered machine translation engine, into our workflow. When Crowdin receives new texts for translation, DeepL automatically translates them. Upon detecting these new translations, Crowdin will automatically synchronize with GitHub and generate a new PR containing the translated texts. This procedure typically requires a minimum of 5 to 10 minutes.

<img src={CrowdinTranslations} height="650" width="900"/>

Developers are required to assign themselves to the PR created by Crowdin if it is relevant to their work. Additionally, developers should update the PR labels and seek a review from another team member as part of their responsibilities. Once the PR has been approved and reviewed successfully, developers are responsible for merging the changes into the production branch promptly.

Translations from DeepL may not accurately capture the intended context. DeepL is unable to discern context until a local user provides clarification. For now translations from DeepL will undergo verification by the users of our app. It's worth noting that DeepL does not support our entire list of translations, leading to instances where some translations returned may be in English.

## Adding New Languages

When adding a new language to our system, it's crucial to follow a structured process to ensure seamless integration and multilingual support.

### Managing Translations With Crowdin

In our localization process, we collaborate with a translations manager in Crowdin. Their pivotal role is to ensure that all files are accurately and completely translated into our desired languages. Once the translations manager confirms the full translation of a language, the next step is to add support for that language within our system.

<img src={LanguageTranslated} height="50" width="900"/>

### 1. Update next i18n Configuration

Modify the next i18n configuration file (`next-i18next.config.js`) to include the new locale. This involves adding the two-letter language code (e.g. ar - Arabic). Ensure consistency by checking either the folder or files returned in the Pull Request generated by Crowdin or the locales folder in the libs directory. Verify that the supported languages match and adhere to the established folder structure and file naming conventions.

Ensure that you add both the two-letter language code and specific variants directly in the `locales` array when needed. When adding a specific variant, it's good to define its two-letter version. We do this in order to support fallback languages if other variants aren't available.

```jsx
import path from 'path'

/**
 * @type {import('next-i18next').UserConfig}
 **/
const i18nConfig = {
  i18n: {
    defaultLocale: 'en',
    locales: [
      'en',
      'es', // Spanish
      'ar', // Arabic
      'zh', // Two-letter version for Chinese (Simplified)
      // Add the new locale here with two-letter language code and specific variants when needed
      'zh-Hans-CN' // Chinese (Simplified) with a specific variant
    ],
    fallbackLng: {
      default: ['en'],
      ar: ['ar-SA'],
      es: ['es-ES'],
      // Ensure that specific variants are also included in fallbackLng
      zh: ['zh-Hans-CN'] // Mapping the two-letter code to the right folder
    },
    localePath: path.resolve('./libs/locales')
  }
}

export default i18nConfig
```

### 2. Update Supported Locales in Middleware

Update the supported locales in the middleware to reflect your changes.

```jsx
const supportedLocales = [
  'en', // English
  'es', // Spanish
  'ar', // Arabic
  'zh', // Include the two-letter version for Chinese (Simplified)
  'zh-Hans-CN' // Include the new locale with variant here
]
```

By following these steps, you ensure clarity in adding both the two-letter language code and specific variants directly in the `locales` array. Additionally, when adding a specific variant, always define its two-letter version for consistency and proper fallback handling. This allows for seamless integration of new translations while maintaining a standardized approach.
